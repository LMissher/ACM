# 2017北京 C
https://hihocoder.com/problemset/problem/1629

给出一幅图，然后q次询问，每次询问问区间 $[l,r]$ 的点有多少点对可以互相到达。  
首先想到一个联通块里有 $ n \times (n-1) \div 2$ 个点对可以互相到达，现在的任务就是寻找每次问题区间里有多少联通块，联通块多大。  
假设只有一次询问，那么不难想到可以使用并查集维护联通性，将所有区间里的点所连的点枚举并用并查集联通即可。  
但是有 $10^{5}$ 个询问，每次从头做并查集复杂度太高，考虑分块。  
可以将询问分为 $\sqrt n$ 块，每块包含 $\sqrt n$ 个点，如果一个询问 $[l,r]$ 全在一块里，那么直接一次并查集查询答案。  
把剩下的询问按左边界放进不同的块里，每一块按照区间右边界从小到大排序。  
那么在一块里的不同查询中，并查集只需要先撤销掉上一次询问的左端点到下一块的左端点的边再连上这一次询问的左端点到下一块的左端点的边与上一次询问的右端点到这一次询问的右端点的边。  
撤销使用可撤销并查集，分块用莫队即可。  

# codeforces 891C

给一幅图，再给 $q$ 个询问，每个询问给出一个边集，询问有哪些边集可以在同一个最小生成树里。  
如果只有一个边集，那么如果将这个边集做一次最小生成树能成功那么就满足条件。  
如何将一个边集做最小生成树呢？先把边按升序排序，那么将一个权值的边放进最小生成树前把小于它的所有权值放进最小生成树里然后再把这个边集的边放进最小生成树不冲突的话就欧克，直到把边集放完即可。  
现在有多个边集，那么多个边集相同的权值会互相影响，因为当单独考虑一个边集时，相同的权值选择当前边集肯定是最优的。那么每次只需要将一个边集的所有等权值边判断后使用可撤销并查集撤销影响即可。那么查询到下一个边集相同的权值边时上一个边集相同的权值边不会对齐造成影响。  
